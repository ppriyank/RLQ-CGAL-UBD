# RLQ-CGAL-UBD
Implementation of Coarse-grained Attribute Learning with Unsupervised Distillation for Real-World Clothes Changing ReID


Please check [Setup](setup.md) for setting up requiste libraries. 


Please check [Scripts](Scripts/ucf2.sh) for running various models.




## Pre Processing 
All Pose Clusters and Gender related Information for each dataset is kept in [Scripts/Helper](Scripts/Helper). This folder also has a list of all RGB images where silhouttes are faulty, and size csv to get a size buckets images fall in.  

  - (**Provided**) Genders were manullay generated.   
  - (**Provided**) Size is measure of spatial resolution. 
  - (**Needed**) Silhouttes were generated by [Self-Correction for Human Parsing](https://github.com/GoGoDuck912/Self-Correction-Human-Parsinghttps://github.com/GoGoDuck912/Self-Correction-Human-Parsing) with pretrained weights (`checkpoints/exp-schp-201908261155-lip.pth`). The script should generate npy dumps.
    - [Prep Mask](Scripts/Processing/prep_mask.py) will convert npys to requiste masks (pants and tops) 
  - (**Provided**) [Alpha Pose](https://github.com/MVIG-SJTU/AlphaPose) is used to dump 2D skeleton. Config: `configs/coco/resnet/256x192_res50_lr1e-3_1x.yaml` , Model Wt: `pretrained_models/fast_res50_256x192.pth`  
    - Pose clusters are generated via [Prep Pose](Scripts/Processing/prep_pose.py)  with cluster size of 5,10,15,20,15,25,30,35,40 : 

| **Pose Vector** |                               **Description**                               |
|-----------------|-----------------------------------------------------------------------------|
| R_LA            | Poses vectors is length and angle of Body lines (Selected for final model)  |
| R_LAC           | Poses vectors is length and angle of Body lines + Coordinates of joints     |
| R_A             | Poses vectors is only angle of Body lines (Selected for final model)        |
| N_LA            | R_LA w/o resizing from 2d skeleton model output (code needs to be modified) |
| N_LAC           | R_LAC w/o resizing from 2d skeleton model output (code needs to be modified)|
| N_A             | R_A  w/o resizing from 2d skeleton model output (code needs to be modified) |





